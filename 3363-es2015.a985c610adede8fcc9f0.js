(self.webpackChunkion_tk_social_network=self.webpackChunkion_tk_social_network||[]).push([[3363],{23363:function(n,e,i){"use strict";i.r(e),i.d(e,{MessagesPageModule:function(){return U}});var o=i(61116),t=i(75425),s=i(6921),a=i(57476),c=i(39238),r=i(64762),l=i(31041),g=i(74249),u=i(61071),d=i(9153),h=i(18995),f=i(30519),m=i(49536),p=i(33316),Z=i(85649);function w(n,e){1&n&&(p.TgZ(0,"ion-title"),p._uU(1),p.ALo(2,"translate"),p._UZ(3,"ion-icon",13),p.qZA()),2&n&&(p.xp6(1),p.hij(" ",p.lcZ(2,1,"bottomTabs.messages")," "))}function A(n,e){if(1&n){const n=p.EpF();p.TgZ(0,"ion-searchbar",14),p.NdJ("ionCancel",function(){return p.CHM(n),p.oxw().showSearchbar=!1}),p.ALo(1,"translate"),p.qZA()}if(2&n){const n=p.oxw();p.Q6J("formControl",n.searchMessageList)("placeholder",p.lcZ(1,2,"messagesSearchTitle"))}}function b(n,e){if(1&n){const n=p.EpF();p.TgZ(0,"ion-button",15),p.NdJ("click",function(){return p.CHM(n),p.oxw().showSearchbar=!0}),p._UZ(1,"ion-icon",16),p.qZA()}}function q(n,e){1&n&&(p.TgZ(0,"ion-button",17),p._UZ(1,"ion-icon",18),p.qZA())}function M(n,e){if(1&n&&(p._UZ(0,"ion-searchbar",19),p.ALo(1,"translate")),2&n){const n=p.oxw();p.Q6J("formControl",n.searchMessageList)("placeholder",p.lcZ(1,2,"messagesSearchTitle"))}}function T(n,e){1&n&&(p.TgZ(0,"ion-item"),p.TgZ(1,"ion-avatar",21),p._UZ(2,"ion-skeleton-text",22),p.qZA(),p.TgZ(3,"ion-label"),p.TgZ(4,"h2"),p._UZ(5,"ion-skeleton-text",23),p.qZA(),p.TgZ(6,"p"),p._UZ(7,"ion-skeleton-text",24),p.qZA(),p.qZA(),p.qZA())}const v=function(){return[1,2,3,4,5,6,7,8]};function x(n,e){1&n&&(p.ynx(0),p.YNc(1,T,8,0,"ion-item",20),p.BQk()),2&n&&(p.xp6(1),p.Q6J("ngForOf",p.DdM(1,v)))}function y(n,e){1&n&&p._UZ(0,"ion-icon",37)}function I(n,e){if(1&n){const n=p.EpF();p.TgZ(0,"ion-item-option",38),p.NdJ("click",function(){p.CHM(n);const e=p.oxw().$implicit;return p.oxw().pinMessage(e.id)}),p._UZ(1,"ion-icon",39),p.TgZ(2,"ion-label"),p._uU(3," Pin "),p.qZA(),p.qZA()}}function _(n,e){if(1&n){const n=p.EpF();p.TgZ(0,"ion-item-option",38),p.NdJ("click",function(){p.CHM(n);const e=p.oxw().$implicit;return p.oxw().unPinMessage(e.id)}),p._UZ(1,"ion-icon",40),p.TgZ(2,"ion-label"),p._uU(3," UnPin "),p.qZA(),p.qZA()}}function J(n,e){if(1&n){const n=p.EpF();p.TgZ(0,"ion-item-sliding"),p.TgZ(1,"ion-item",25),p.NdJ("click",function(){const e=p.CHM(n).$implicit;return p.oxw().openMessageDetail(e)}),p.TgZ(2,"ion-avatar",21),p._UZ(3,"img",26),p.qZA(),p.TgZ(4,"ion-label"),p.TgZ(5,"h2"),p._uU(6),p.qZA(),p.TgZ(7,"p"),p._uU(8),p.qZA(),p.qZA(),p.YNc(9,y,1,0,"ion-icon",27),p.qZA(),p.TgZ(10,"ion-item-options",28),p.TgZ(11,"ion-item-option",29),p._UZ(12,"ion-icon",30),p.TgZ(13,"ion-label"),p._uU(14," Not readed "),p.qZA(),p.qZA(),p.YNc(15,I,4,0,"ion-item-option",31),p.YNc(16,_,4,0,"ion-item-option",31),p.qZA(),p.TgZ(17,"ion-item-options",32),p.TgZ(18,"ion-item-option",33),p._UZ(19,"ion-icon",34),p.TgZ(20,"ion-label"),p._uU(21," Mute "),p.qZA(),p.qZA(),p.TgZ(22,"ion-item-option",35),p._UZ(23,"ion-icon",36),p.TgZ(24,"ion-label"),p._uU(25," Delete "),p.qZA(),p.qZA(),p.qZA(),p.qZA()}if(2&n){const n=e.$implicit,i=e.ngForOf,o=e.index;p.xp6(1),p.Q6J("lines",n.isPin?i[o+1].isPin?"none":"full":"none"),p.xp6(2),p.Q6J("src",n.avatar,p.LSH),p.xp6(3),p.AsE("",n.firstName," ",n.lastName,""),p.xp6(2),p.Oqu(n.lastMessage),p.xp6(1),p.Q6J("ngIf",n.isPin),p.xp6(6),p.Q6J("ngIf",!n.isPin),p.xp6(1),p.Q6J("ngIf",n.isPin)}}function k(n,e){1&n&&(p.TgZ(0,"div",41),p.TgZ(1,"p"),p._uU(2,"\u041f\u043e \u0432\u0430\u0448\u0435\u043c\u0443 \u0437\u0430\u043f\u0440\u043e\u0441\u0443 \u043d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e"),p.qZA(),p.qZA())}const C=[{path:"",component:(()=>{class n{constructor(n,e,i){this.store=n,this.config=e,this.navController=i,this.searchMessageList=new l.NI(""),this.showSearchbar=!1,this.isIos=!1,this.isIos="ios"===this.config.get("mode")}trackByMessages(n){return n}doRefresh(n){return(0,r.mG)(this,void 0,void 0,function*(){this.searchMessageList.setValue("",{emitEvent:!1}),yield(0,d.n)(this.store.dispatch(new f.qK.FetchMessages(this.searchMessageList.value,1,!0))),yield this.ionRefresher.complete()})}openMessageDetail(n){this.navController.navigateForward(`/message-detail/${n.id}`)}pinMessage(n){return(0,r.mG)(this,void 0,void 0,function*(){yield(0,d.n)(this.store.dispatch(new f.vm(n))),yield this.ionItemSliding.closeOpened()})}unPinMessage(n){return(0,r.mG)(this,void 0,void 0,function*(){yield(0,d.n)(this.store.dispatch(new f.nZ(n))),yield this.ionItemSliding.closeOpened()})}loadData(n){return(0,r.mG)(this,void 0,void 0,function*(){const n=this.store.selectSnapshot(n=>n.messages.messages.activePage);yield(0,d.n)(this.store.dispatch(new f.qK.FetchMessages(this.searchMessageList.value,n+1,!1))),yield this.infiniteScroll.complete()})}ngOnInit(){return(0,r.mG)(this,void 0,void 0,function*(){const n=this.store.selectSnapshot(n=>n.messages.messages.activePage);this.searchMessageList.valueChanges.pipe((0,h.b)(300)).subscribe(e=>{this.store.dispatch(new f.qK.FetchMessages(e,n,!0))})})}ionViewDidEnter(){return(0,r.mG)(this,void 0,void 0,function*(){const n=this.store.selectSnapshot(n=>n.messages.messages.activePage);yield(0,d.n)(this.store.dispatch(new f.qK.FetchMessages(this.searchMessageList.value,n)))})}ionViewDidLeave(){}}return n.\u0275fac=function(e){return new(e||n)(p.Y36(u.yh),p.Y36(g.De),p.Y36(g.SH))},n.\u0275cmp=p.Xpm({type:n,selectors:[["app-messages"]],viewQuery:function(n,e){if(1&n&&(p.Gf(g.W2,5),p.Gf(g.nJ,5),p.Gf(g.td,5),p.Gf(g.ju,5)),2&n){let n;p.iGM(n=p.CRH())&&(e.ionContent=n.first),p.iGM(n=p.CRH())&&(e.ionRefresher=n.first),p.iGM(n=p.CRH())&&(e.ionItemSliding=n.first),p.iGM(n=p.CRH())&&(e.infiniteScroll=n.first)}},decls:21,vars:18,consts:[[3,"translucent"],[4,"ngIf"],["showCancelButton","always","cancelButtonIcon","arrow-back-outline",3,"formControl","placeholder","ionCancel",4,"ngIf"],["slot","end"],["color","primary",3,"click",4,"ngIf"],["color","primary",4,"ngIf"],["slot","fixed","pullFactor","0.5","pullMin","60","pullMax","200",3,"ionRefresh"],["cancelButtonIcon","arrow-back-outline",3,"formControl","placeholder",4,"ngIf"],["lines","none",1,"ion-padding-bottom"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","ion-margin ion-text-center",4,"ngIf"],["threshold","100px",3,"ionInfinite"],["loadingSpinner","lines"],["name","chevron-down-outline","color","primary",1,"message-icon-middle"],["showCancelButton","always","cancelButtonIcon","arrow-back-outline",3,"formControl","placeholder","ionCancel"],["color","primary",3,"click"],["slot","icon-only","name","search-outline"],["color","primary"],["slot","icon-only","name","create-outline"],["cancelButtonIcon","arrow-back-outline",3,"formControl","placeholder"],[4,"ngFor","ngForOf"],["slot","start"],[2,"border-radius","50%"],[2,"width","50%"],[2,"width","80%"],["button","","detail","false",3,"lines","click"],[3,"src"],["name","arrow-up-circle-outline","slot","end",4,"ngIf"],["side","start"],["color","primary","expandable",""],["slot","start","name","chatbubble-ellipses-outline"],["color","medium",3,"click",4,"ngIf"],["side","end"],["color","medium"],["slot","start","name","volume-mute-outline"],["color","danger","expandable",""],["slot","start","name","trash-outline"],["name","arrow-up-circle-outline","slot","end"],["color","medium",3,"click"],["slot","start","name","arrow-up-circle-outline"],["slot","start","name","arrow-down-circle-outline"],[1,"ion-margin","ion-text-center"]],template:function(n,e){1&n&&(p.TgZ(0,"ion-header",0),p.TgZ(1,"ion-toolbar"),p.YNc(2,w,4,3,"ion-title",1),p.YNc(3,A,2,4,"ion-searchbar",2),p.TgZ(4,"ion-buttons",3),p.YNc(5,b,2,0,"ion-button",4),p.YNc(6,q,2,0,"ion-button",5),p.qZA(),p.qZA(),p.qZA(),p.TgZ(7,"ion-content"),p.TgZ(8,"ion-refresher",6),p.NdJ("ionRefresh",function(n){return e.doRefresh(n)}),p._UZ(9,"ion-refresher-content"),p.qZA(),p.YNc(10,M,2,4,"ion-searchbar",7),p.TgZ(11,"ion-list",8),p.YNc(12,x,2,2,"ng-container",1),p.ALo(13,"async"),p.YNc(14,J,26,8,"ion-item-sliding",9),p.ALo(15,"async"),p.qZA(),p.YNc(16,k,3,0,"div",10),p.ALo(17,"async"),p.ALo(18,"async"),p.TgZ(19,"ion-infinite-scroll",11),p.NdJ("ionInfinite",function(n){return e.loadData(n)}),p._UZ(20,"ion-infinite-scroll-content",12),p.qZA(),p.qZA()),2&n&&(p.Q6J("translucent",!0),p.xp6(2),p.Q6J("ngIf",!e.showSearchbar),p.xp6(1),p.Q6J("ngIf",e.showSearchbar),p.xp6(2),p.Q6J("ngIf",!e.isIos&&!e.showSearchbar),p.xp6(1),p.Q6J("ngIf",!e.showSearchbar),p.xp6(4),p.Q6J("ngIf",e.isIos),p.xp6(2),p.Q6J("ngIf",p.lcZ(13,10,e.loadingMessagesStates$).isLoading),p.xp6(2),p.Q6J("ngForOf",p.lcZ(15,12,e.messages$))("ngForTrackBy",e.trackByMessages),p.xp6(2),p.Q6J("ngIf",!p.lcZ(17,14,e.loadingMessagesStates$).isLoading&&!p.lcZ(18,16,e.messages$).length))},directives:[g.Gu,g.sr,o.O5,g.Sm,g.W2,g.nJ,g.Wo,g.q_,o.sg,g.ju,g.MB,g.wd,g.gu,g.VI,g.j9,l.JJ,l.oH,g.YG,g.Ie,g.BJ,g.CK,g.Q$,g.td,g.IK,g.u8],pipes:[o.Ov,Z.X$],styles:[".message-icon-middle[_ngcontent-%COMP%]{vertical-align:middle}"]}),(0,r.gn)([(0,u.Ph)((0,u.P1)([m.fU],n=>n.messages.pages.map(e=>n.messages.listData[e]).reduce((n,e)=>n.concat(e),[]).slice().sort((n,e)=>+e.isPin-+n.isPin)))],n.prototype,"messages$",void 0),(0,r.gn)([(0,u.Ph)((0,u.P1)([m.fU],n=>({isLoading:n.messages.isLoading,isSuccess:n.messages.isSuccess,isFailed:n.messages.isFailed})))],n.prototype,"loadingMessagesStates$",void 0),n})()}];let S=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=p.oAB({type:n}),n.\u0275inj=p.cJS({imports:[[c.Bz.forChild(C)],c.Bz]}),n})(),U=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=p.oAB({type:n}),n.\u0275inj=p.cJS({imports:[[o.ez,S,s.H,a.i,t.m]]}),n})()}}]);