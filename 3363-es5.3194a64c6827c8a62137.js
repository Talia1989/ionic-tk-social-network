!function(){function e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function n(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(self.webpackChunkion_tk_social_network=self.webpackChunkion_tk_social_network||[]).push([[3363],{23363:function(t,i,o){"use strict";o.r(i),o.d(i,{MessagesPageModule:function(){return L}});var r=o(61116),s=o(75425),a=o(6921),c=o(57476),l=o(39238),u=o(64762),g=o(31041),f=o(74249),h=o(61071),p=o(9153),m=o(18995),d=o(30519),Z=o(49536),v=o(33316),w=o(85649);function x(e,n){1&e&&(v.TgZ(0,"ion-title"),v._uU(1),v.ALo(2,"translate"),v._UZ(3,"ion-icon",13),v.qZA()),2&e&&(v.xp6(1),v.hij(" ",v.lcZ(2,1,"bottomTabs.messages")," "))}function b(e,n){if(1&e){var t=v.EpF();v.TgZ(0,"ion-searchbar",14),v.NdJ("ionCancel",function(){return v.CHM(t),v.oxw().showSearchbar=!1}),v.ALo(1,"translate"),v.qZA()}if(2&e){var i=v.oxw();v.Q6J("formControl",i.searchMessageList)("placeholder",v.lcZ(1,2,"messagesSearchTitle"))}}function A(e,n){if(1&e){var t=v.EpF();v.TgZ(0,"ion-button",15),v.NdJ("click",function(){return v.CHM(t),v.oxw().showSearchbar=!0}),v._UZ(1,"ion-icon",16),v.qZA()}}function k(e,n){1&e&&(v.TgZ(0,"ion-button",17),v._UZ(1,"ion-icon",18),v.qZA())}function q(e,n){if(1&e&&(v._UZ(0,"ion-searchbar",19),v.ALo(1,"translate")),2&e){var t=v.oxw();v.Q6J("formControl",t.searchMessageList)("placeholder",v.lcZ(1,2,"messagesSearchTitle"))}}function T(e,n){1&e&&(v.TgZ(0,"ion-item"),v.TgZ(1,"ion-avatar",21),v._UZ(2,"ion-skeleton-text",22),v.qZA(),v.TgZ(3,"ion-label"),v.TgZ(4,"h2"),v._UZ(5,"ion-skeleton-text",23),v.qZA(),v.TgZ(6,"p"),v._UZ(7,"ion-skeleton-text",24),v.qZA(),v.qZA(),v.qZA())}var M=function(){return[1,2,3,4,5,6,7,8]};function y(e,n){1&e&&(v.ynx(0),v.YNc(1,T,8,0,"ion-item",20),v.BQk()),2&e&&(v.xp6(1),v.Q6J("ngForOf",v.DdM(1,M)))}function I(e,n){1&e&&v._UZ(0,"ion-icon",37)}function _(e,n){if(1&e){var t=v.EpF();v.TgZ(0,"ion-item-option",38),v.NdJ("click",function(){v.CHM(t);var e=v.oxw().$implicit;return v.oxw().pinMessage(e.id)}),v._UZ(1,"ion-icon",39),v.TgZ(2,"ion-label"),v._uU(3," Pin "),v.qZA(),v.qZA()}}function J(e,n){if(1&e){var t=v.EpF();v.TgZ(0,"ion-item-option",38),v.NdJ("click",function(){v.CHM(t);var e=v.oxw().$implicit;return v.oxw().unPinMessage(e.id)}),v._UZ(1,"ion-icon",40),v.TgZ(2,"ion-label"),v._uU(3," UnPin "),v.qZA(),v.qZA()}}function C(e,n){if(1&e){var t=v.EpF();v.TgZ(0,"ion-item-sliding"),v.TgZ(1,"ion-item",25),v.NdJ("click",function(){var e=v.CHM(t).$implicit;return v.oxw().openMessageDetail(e)}),v.TgZ(2,"ion-avatar",21),v._UZ(3,"img",26),v.qZA(),v.TgZ(4,"ion-label"),v.TgZ(5,"h2"),v._uU(6),v.qZA(),v.TgZ(7,"p"),v._uU(8),v.qZA(),v.qZA(),v.YNc(9,I,1,0,"ion-icon",27),v.qZA(),v.TgZ(10,"ion-item-options",28),v.TgZ(11,"ion-item-option",29),v._UZ(12,"ion-icon",30),v.TgZ(13,"ion-label"),v._uU(14," Not readed "),v.qZA(),v.qZA(),v.YNc(15,_,4,0,"ion-item-option",31),v.YNc(16,J,4,0,"ion-item-option",31),v.qZA(),v.TgZ(17,"ion-item-options",32),v.TgZ(18,"ion-item-option",33),v._UZ(19,"ion-icon",34),v.TgZ(20,"ion-label"),v._uU(21," Mute "),v.qZA(),v.qZA(),v.TgZ(22,"ion-item-option",35),v._UZ(23,"ion-icon",36),v.TgZ(24,"ion-label"),v._uU(25," Delete "),v.qZA(),v.qZA(),v.qZA(),v.qZA()}if(2&e){var i=n.$implicit,o=n.ngForOf,r=n.index;v.xp6(1),v.Q6J("lines",i.isPin?o[r+1].isPin?"none":"full":"none"),v.xp6(2),v.Q6J("src",i.avatar,v.LSH),v.xp6(3),v.AsE("",i.firstName," ",i.lastName,""),v.xp6(2),v.Oqu(i.lastMessage),v.xp6(1),v.Q6J("ngIf",i.isPin),v.xp6(6),v.Q6J("ngIf",!i.isPin),v.xp6(1),v.Q6J("ngIf",i.isPin)}}function S(e,n){1&e&&(v.TgZ(0,"div",41),v.TgZ(1,"p"),v._uU(2,"\u041f\u043e \u0432\u0430\u0448\u0435\u043c\u0443 \u0437\u0430\u043f\u0440\u043e\u0441\u0443 \u043d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e"),v.qZA(),v.qZA())}var U,N,F=[{path:"",component:(U=function(){function t(n,i,o){e(this,t),this.store=n,this.config=i,this.navController=o,this.searchMessageList=new g.NI(""),this.showSearchbar=!1,this.isIos=!1,this.isIos="ios"===this.config.get("mode")}var i,o,r;return i=t,(o=[{key:"trackByMessages",value:function(e){return e}},{key:"doRefresh",value:function(e){return(0,u.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.searchMessageList.setValue("",{emitEvent:!1}),e.next=3,(0,p.n)(this.store.dispatch(new d.qK.FetchMessages(this.searchMessageList.value,1,!0)));case 3:return e.next=5,this.ionRefresher.complete();case 5:case"end":return e.stop()}},e,this)}))}},{key:"openMessageDetail",value:function(e){this.navController.navigateForward("/message-detail/".concat(e.id))}},{key:"pinMessage",value:function(e){return(0,u.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,p.n)(this.store.dispatch(new d.vm(e)));case 2:return n.next=4,this.ionItemSliding.closeOpened();case 4:case"end":return n.stop()}},n,this)}))}},{key:"unPinMessage",value:function(e){return(0,u.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,p.n)(this.store.dispatch(new d.nZ(e)));case 2:return n.next=4,this.ionItemSliding.closeOpened();case 4:case"end":return n.stop()}},n,this)}))}},{key:"loadData",value:function(e){return(0,u.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.store.selectSnapshot(function(e){return e.messages.messages.activePage}),e.next=3,(0,p.n)(this.store.dispatch(new d.qK.FetchMessages(this.searchMessageList.value,n+1,!1)));case 3:return e.next=5,this.infiniteScroll.complete();case 5:case"end":return e.stop()}},e,this)}))}},{key:"ngOnInit",value:function(){return(0,u.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var n,t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=this.store.selectSnapshot(function(e){return e.messages.messages.activePage}),this.searchMessageList.valueChanges.pipe((0,m.b)(300)).subscribe(function(e){t.store.dispatch(new d.qK.FetchMessages(e,n))});case 2:case"end":return e.stop()}},e,this)}))}},{key:"ionViewDidEnter",value:function(){return(0,u.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.store.selectSnapshot(function(e){return e.messages.messages.activePage}),e.next=3,(0,p.n)(this.store.dispatch(new d.qK.FetchMessages(this.searchMessageList.value,n)));case 3:case"end":return e.stop()}},e,this)}))}},{key:"ionViewDidLeave",value:function(){}}])&&n(i.prototype,o),r&&n(i,r),t}(),U.\u0275fac=function(e){return new(e||U)(v.Y36(h.yh),v.Y36(f.De),v.Y36(f.SH))},U.\u0275cmp=v.Xpm({type:U,selectors:[["app-messages"]],viewQuery:function(e,n){var t;1&e&&(v.Gf(f.W2,5),v.Gf(f.nJ,5),v.Gf(f.td,5),v.Gf(f.ju,5)),2&e&&(v.iGM(t=v.CRH())&&(n.ionContent=t.first),v.iGM(t=v.CRH())&&(n.ionRefresher=t.first),v.iGM(t=v.CRH())&&(n.ionItemSliding=t.first),v.iGM(t=v.CRH())&&(n.infiniteScroll=t.first))},decls:21,vars:18,consts:[[3,"translucent"],[4,"ngIf"],["showCancelButton","always","cancelButtonIcon","arrow-back-outline",3,"formControl","placeholder","ionCancel",4,"ngIf"],["slot","end"],["color","primary",3,"click",4,"ngIf"],["color","primary",4,"ngIf"],["slot","fixed","pullFactor","0.5","pullMin","60","pullMax","200",3,"ionRefresh"],["cancelButtonIcon","arrow-back-outline",3,"formControl","placeholder",4,"ngIf"],["lines","none",1,"ion-padding-bottom"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","ion-margin ion-text-center",4,"ngIf"],["threshold","100px",3,"ionInfinite"],["loadingSpinner","lines"],["name","chevron-down-outline","color","primary",1,"message-icon-middle"],["showCancelButton","always","cancelButtonIcon","arrow-back-outline",3,"formControl","placeholder","ionCancel"],["color","primary",3,"click"],["slot","icon-only","name","search-outline"],["color","primary"],["slot","icon-only","name","create-outline"],["cancelButtonIcon","arrow-back-outline",3,"formControl","placeholder"],[4,"ngFor","ngForOf"],["slot","start"],[2,"border-radius","50%"],[2,"width","50%"],[2,"width","80%"],["button","","detail","false",3,"lines","click"],[3,"src"],["name","arrow-up-circle-outline","slot","end",4,"ngIf"],["side","start"],["color","primary","expandable",""],["slot","start","name","chatbubble-ellipses-outline"],["color","medium",3,"click",4,"ngIf"],["side","end"],["color","medium"],["slot","start","name","volume-mute-outline"],["color","danger","expandable",""],["slot","start","name","trash-outline"],["name","arrow-up-circle-outline","slot","end"],["color","medium",3,"click"],["slot","start","name","arrow-up-circle-outline"],["slot","start","name","arrow-down-circle-outline"],[1,"ion-margin","ion-text-center"]],template:function(e,n){1&e&&(v.TgZ(0,"ion-header",0),v.TgZ(1,"ion-toolbar"),v.YNc(2,x,4,3,"ion-title",1),v.YNc(3,b,2,4,"ion-searchbar",2),v.TgZ(4,"ion-buttons",3),v.YNc(5,A,2,0,"ion-button",4),v.YNc(6,k,2,0,"ion-button",5),v.qZA(),v.qZA(),v.qZA(),v.TgZ(7,"ion-content"),v.TgZ(8,"ion-refresher",6),v.NdJ("ionRefresh",function(e){return n.doRefresh(e)}),v._UZ(9,"ion-refresher-content"),v.qZA(),v.YNc(10,q,2,4,"ion-searchbar",7),v.TgZ(11,"ion-list",8),v.YNc(12,y,2,2,"ng-container",1),v.ALo(13,"async"),v.YNc(14,C,26,8,"ion-item-sliding",9),v.ALo(15,"async"),v.qZA(),v.YNc(16,S,3,0,"div",10),v.ALo(17,"async"),v.ALo(18,"async"),v.TgZ(19,"ion-infinite-scroll",11),v.NdJ("ionInfinite",function(e){return n.loadData(e)}),v._UZ(20,"ion-infinite-scroll-content",12),v.qZA(),v.qZA()),2&e&&(v.Q6J("translucent",!0),v.xp6(2),v.Q6J("ngIf",!n.showSearchbar),v.xp6(1),v.Q6J("ngIf",n.showSearchbar),v.xp6(2),v.Q6J("ngIf",!n.isIos&&!n.showSearchbar),v.xp6(1),v.Q6J("ngIf",!n.showSearchbar),v.xp6(4),v.Q6J("ngIf",n.isIos),v.xp6(2),v.Q6J("ngIf",v.lcZ(13,10,n.loadingMessagesStates$).isLoading),v.xp6(2),v.Q6J("ngForOf",v.lcZ(15,12,n.messages$))("ngForTrackBy",n.trackByMessages),v.xp6(2),v.Q6J("ngIf",!v.lcZ(17,14,n.loadingMessagesStates$).isLoading&&!v.lcZ(18,16,n.messages$).length))},directives:[f.Gu,f.sr,r.O5,f.Sm,f.W2,f.nJ,f.Wo,f.q_,r.sg,f.ju,f.MB,f.wd,f.gu,f.VI,f.j9,g.JJ,g.oH,f.YG,f.Ie,f.BJ,f.CK,f.Q$,f.td,f.IK,f.u8],pipes:[r.Ov,w.X$],styles:[".message-icon-middle[_ngcontent-%COMP%]{vertical-align:middle}"]}),(0,u.gn)([(0,h.Ph)((0,h.P1)([Z.fU],function(e){return e.messages.pages.map(function(n){return e.messages.listData[n]}).reduce(function(e,n){return e.concat(n)},[]).slice().sort(function(e,n){return+n.isPin-+e.isPin})}))],U.prototype,"messages$",void 0),(0,u.gn)([(0,h.Ph)((0,h.P1)([Z.fU],function(e){return{isLoading:e.messages.isLoading,isSuccess:e.messages.isSuccess,isFailed:e.messages.isFailed}}))],U.prototype,"loadingMessagesStates$",void 0),U)}],R=function(){var n=function n(){e(this,n)};return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=v.oAB({type:n}),n.\u0275inj=v.cJS({imports:[[l.Bz.forChild(F)],l.Bz]}),n}(),L=((N=function n(){e(this,n)}).\u0275fac=function(e){return new(e||N)},N.\u0275mod=v.oAB({type:N}),N.\u0275inj=v.cJS({imports:[[r.ez,R,a.H,c.i,s.m]]}),N)}}])}();